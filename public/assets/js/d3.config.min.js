"use strict";angular.module("d3").config(["$provide",function(t){var n=function(t){var n=t;return function(t){function r(){function t(t,n,e){for(var a,u,o,i=([{x:0,y:0},{x:r[0],y:r[1]}],n.x),f=n.y,c=Math.sqrt(r[0]*r[0]+r[1]*r[1]),s=b(r),h=Math.random()<.5?1:-1,x=-h;(a=s(x+=h))&&(u=~~a[0],o=~~a[1],!(Math.min(u,o)>c));)if(n.x=i+u,n.y=f+o,!(n.x+n.x0<0||n.y+n.y0<0||n.x+n.x1>r[0]||n.y+n.y1>r[1]||e&&l(n,t,r[0])||e&&!y(n,e))){for(var d,g=n.sprite,v=n.width>>5,m=r[0]>>5,p=n.x-(v<<4),M=127&p,w=32-M,z=n.y1-n.y0,I=(n.y+n.y0)*m+(p>>5),q=0;z>q;q++){d=0;for(var k=0;v>=k;k++)t[I+k]|=d<<w|(v>k?(d=g[q*v+k])>>>M:0);I+=m}return delete n.sprite,!0}return!1}var r=[256,256],x=e,g=a,v=o,m=u,p=u,M=i,w=f,b=h,I=[],q=1/0,k=n.dispatch("word","end"),D=null,S={};return S.start=function(){function n(){for(var n,f=+new Date;+new Date-f<q&&++o<u&&D;)n=l[o],n.x=r[0]*(Math.random()+.5)>>1,n.y=r[1]*(Math.random()+.5)>>1,c(n,l,o),t(e,n,a)&&(i.push(n),k.word(n),a?s(a,n):a=[{x:n.x+n.x0,y:n.y+n.y0},{x:n.x+n.x1,y:n.y+n.y1}],n.x-=r[0]>>1,n.y-=r[1]>>1);o>=u&&(S.stop(),k.end(i,a))}var e=d((r[0]>>5)*r[1]),a=null,u=I.length,o=-1,i=[],l=I.map(function(t,n){return t.text=x.call(this,t,n),t.font=g.call(this,t,n),t.style=m.call(this,t,n),t.weight=p.call(this,t,n),t.rotate=M.call(this,t,n),t.size=~~v.call(this,t,n),t.padding=f.call(this,t,n),t}).sort(function(t,n){return n.size-t.size});return D&&clearInterval(D),D=setInterval(n,0),n(),S},S.stop=function(){return D&&(clearInterval(D),D=null),S},S.timeInterval=function(t){return arguments.length?(q=null==t?1/0:t,S):q},S.words=function(t){return arguments.length?(I=t,S):I},S.size=function(t){return arguments.length?(r=[+t[0],+t[1]],S):r},S.font=function(t){return arguments.length?(g=n.functor(t),S):g},S.fontStyle=function(t){return arguments.length?(m=n.functor(t),S):m},S.fontWeight=function(t){return arguments.length?(p=n.functor(t),S):p},S.rotate=function(t){return arguments.length?(M=n.functor(t),S):M},S.text=function(t){return arguments.length?(x=n.functor(t),S):x},S.spiral=function(t){return arguments.length?(b=z[t+""]||t,S):b},S.fontSize=function(t){return arguments.length?(v=n.functor(t),S):v},S.padding=function(t){return arguments.length?(w=n.functor(t),S):w},n.rebind(S,k,"on")}function e(t){return t.text}function a(){return"serif"}function u(){return"normal"}function o(t){return Math.sqrt(t.value)}function i(){return 30*(~~(6*Math.random())-3)}function f(){return 1}function c(t,n,r){if(!t.sprite){b.clearRect(0,0,(m<<5)/M,p/M);var e=0,a=0,u=0,o=n.length;for(r--;++r<o;){t=n[r],b.save(),b.font=t.style+" "+t.weight+" "+~~((t.size+1)/M)+"px "+t.font;var i=b.measureText(t.text+"m").width*M,f=t.size<<1;if(t.rotate){var c=Math.sin(t.rotate*v),l=Math.cos(t.rotate*v),s=i*l,y=i*c,h=f*l,x=f*c;i=Math.max(Math.abs(s+x),Math.abs(s-x))+31>>5<<5,f=~~Math.max(Math.abs(y+h),Math.abs(y-h))}else i=i+31>>5<<5;if(f>u&&(u=f),e+i>=m<<5&&(e=0,a+=u,u=0),a+f>=p)break;b.translate((e+(i>>1))/M,(a+(f>>1))/M),t.rotate&&b.rotate(t.rotate*v),b.fillText(t.text,0,0),b.restore(),t.width=i,t.height=f,t.xoff=e,t.yoff=a,t.x1=i>>1,t.y1=f>>1,t.x0=-t.x1,t.y0=-t.y1,e+=i}for(var d=b.getImageData(0,0,(m<<5)/M,p/M).data,g=[];--r>=0;){t=n[r];for(var i=t.width,w=i>>5,f=t.y1-t.y0,z=t.padding,I=0;f*w>I;I++)g[I]=0;if(e=t.xoff,null==e)return;a=t.yoff;for(var q=0,k=-1,D=0;f>D;D++){for(var I=0;i>I;I++){var S=w*D+(I>>5),C=d[(a+D)*(m<<5)+(e+I)<<2]?1<<31-I%32:0;z&&(D&&(g[S-w]|=C),i-1>D&&(g[S+w]|=C),C|=C<<1|C>>1),g[S]|=C,q|=C}q?k=D:(t.y0++,f--,D--,a++)}t.y1=t.y0+k,t.sprite=g.slice(0,(t.y1-t.y0)*w)}}}function l(t,n,r){r>>=5;for(var e,a=t.sprite,u=t.width>>5,o=t.x-(u<<4),i=127&o,f=32-i,c=t.y1-t.y0,l=(t.y+t.y0)*r+(o>>5),s=0;c>s;s++){e=0;for(var y=0;u>=y;y++)if((e<<f|(u>y?(e=a[s*u+y])>>>i:0))&n[l+y])return!0;l+=r}return!1}function s(t,n){var r=t[0],e=t[1];n.x+n.x0<r.x&&(r.x=n.x+n.x0),n.y+n.y0<r.y&&(r.y=n.y+n.y0),n.x+n.x1>e.x&&(e.x=n.x+n.x1),n.y+n.y1>e.y&&(e.y=n.y+n.y1)}function y(t,n){return t.x+t.x1>n[0].x&&t.x+t.x0<n[1].x&&t.y+t.y1>n[0].y&&t.y+t.y0<n[1].y}function h(t){var n=t[0]/t[1];return function(t){return[n*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function x(t){var n=4,r=n*t[0]/t[1],e=0,a=0;return function(t){var u=0>t?-1:1;switch(Math.sqrt(1+4*u*t)-u&3){case 0:e+=r;break;case 1:a+=n;break;case 2:e-=r;break;default:a-=n}return[e,a]}}function d(t){for(var n=[],r=-1;++r<t;)n[r]=0;return n}var g,v=Math.PI/180,m=64,p=2048,M=1;if("undefined"!=typeof document)g=document.createElement("canvas"),g.width=1,g.height=1,M=Math.sqrt(g.getContext("2d").getImageData(0,0,1,1).data.length>>2),g.width=(m<<5)/M,g.height=p/M;else{var w=require("canvas");g=new w(m<<5,p)}var b=g.getContext("2d"),z={archimedean:h,rectangular:x};b.fillStyle="red",b.textAlign="center",t.cloud=r}("undefined"==typeof exports?n.layout||(n.layout={}):exports),n};t.decorator("d3",n)}]);